C##_SPT,C##_SPT_DESTINO
true,,select a.id_usuario, b.id_historial_de_reproduccion, a.nombre_usuario,nvl( d.nombre_plan, 'Sin plan') nombre_plan, e.nombre_genero  from C##_SPT.tbl_usuarios a inner join C##_SPT.tbl_usuario_estandar b on a.id_usuario = b.id_usuario left join C##_SPT.tbl_pago_planes c on a.id_usuario = c.id_usuario left join C##_SPT.tbl_planes d on c.id_plan = d.id_plan left join C##_SPT.tbl_genero e on a.id_genero = e.id_genero where id_tipo_usuario = 2,,TBL_USUARIO,,ID_USUARIO,,ID_USUARIO,,ID_HISTORIAL_DE_REPRODUCCION,,ID_HISTORIAL_REPRO,,NOMBRE_USUARIO,,USUARIO,,NOMBRE_PLAN,,PLAN,,NOMBRE_GENERO,,GENERO
true,,select *  from C##_SPT. tbl_usuarios where id_tipo_usuario in (1,3),,TBL_ARTISTA,,ID_USUARIO,,ID_ARTISTA,,NOMBRE_USUARIO,,ARTISTA
true,,SELECT a.id_media, a.nombre_media, d.tipo_media, nvl(e.nombre_idioma, 'Ninguno') nombre_idioma, nvl(COALESCE(f.nombre_genero_musical, h.genero_podcast), 'Sin genero') AS genero, count(1) as union_c  from C##_SPT.tbl_media a LEFT join C##_SPT.tbl_canciones b ON a.id_media = b.id_cancion LEFT join C##_SPT.tbl_podcasts c ON a.id_media = c.id_podcast INNER join C##_SPT.tbl_tipo_media d ON a.id_tipo_media = d.id_tipo_media LEFT join C##_SPT.tbl_idiomas e ON b.id_idioma = e.id_idioma OR c.id_idioma = e.id_idioma LEFT join C##_SPT.tbl_generos_musicales f ON b.id_genero_musical = f.id_genero_musical LEFT join C##_SPT.tbl_podcast_x_generos g ON c.id_podcast = g.id_podcast LEFT join C##_SPT.tbl_genero_podcast h ON c.id_podcast = h.id_genero_podcast group by a.id_media, a.nombre_media, d.tipo_media, nvl(e.nombre_idioma, 'Ninguno') , nvl(COALESCE(f.nombre_genero_musical, h.genero_podcast), 'Sin genero'),,TBL_MEDIA,,ID_MEDIA,,ID_MEDIA,,NOMBRE_MEDIA,,NOMBRE_MEDIA,,TIPO_MEDIA,,TIPO_MEDIA,,NOMBRE_IDIOMA,,IDIOMA,,GENERO,,GENERO_MEDIA
true,,select row_number() over (order by fecha_reproduccion) as id_tiempo ,to_char(a.fecha_reproduccion, 'yyyy') anio, to_char(a.fecha_reproduccion, 'month') mes,  to_char(a.fecha_reproduccion, 'day') dia   from C##_SPT. tbl_historial_media a,,TBL_TIEMPO,,ID_TIEMPO,,ID_TIEMPO,,ANIO,,ANIO,,MES,,MES,,DIA,,DIA
true,,SELECT *  from C##_SPT. tbl_paises,,TBL_PAIS,,ID_PAIS,,ID_PAIS,,NOMBRE_PAIS,,PAIS
true,,SELECT ROW_NUMBER() OVER (ORDER BY a.id_media) AS id_hechos, NVL(NVL(b.id_artista, c.id_podcaster), 0) AS id_artistas, NVL(f.id_pais, 0) AS id_pais, a.id_media, NVL(d.id_historial_reproduccion, 0) AS id_tiempo_reproduccion, NVL(e.id_usuario, 0) AS id_usuario, COUNT(d.id_historial_reproduccion) AS cantidad_reproducciones, COUNT(NVL(b.id_artista, c.id_podcaster)) AS cantidad_contenido   from C##_SPT.tbl_media a LEFT join C##_SPT.tbl_canciones b ON a.id_media = b.id_cancion LEFT join C##_SPT.tbl_podcasts c ON a.id_media = c.id_podcast LEFT join C##_SPT.tbl_historial_media d ON a.id_media = d.id_media LEFT join C##_SPT.tbl_usuario_estandar e ON d.id_historial_reproduccion = e.id_historial_de_reproduccion INNER join C##_SPT.tbl_usuarios f ON e.id_usuario = f.id_usuario GROUP BY a.id_media, NVL(NVL(b.id_artista, c.id_podcaster), 0), NVL(f.id_pais, 0), NVL(d.id_historial_reproduccion, 0), NVL(e.id_usuario, 0) HAVING NVL(NVL(b.id_artista, c.id_podcaster), 0) != 0 OR NVL(f.id_pais, 0) != 0 OR a.id_media IS NOT NULL OR NVL(d.id_historial_reproduccion, 0) != 0 OR NVL(e.id_usuario, 0) != 0,,TBL_HECHOS,,ID_HECHOS,,ID_TBL_HECHOS,,ID_ARTISTAS,,ID_ARTISTA,,ID_PAIS,,ID_PAIS,,ID_MEDIA,,ID_MEDIA,,ID_TIEMPO_REPRODUCCION,,ID_TIEMPO,,ID_USUARIO,,ID_USUARIO,,CANTIDAD_REPRODUCCIONES,,CANTIDAD_REPRODUCCIONES,,CANTIDAD_CONTENIDO,,CNT_CONTENIDO_AGREGADO
